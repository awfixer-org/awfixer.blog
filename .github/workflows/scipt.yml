name: "Github Sript - replies and labels"

on:
  issues:
    types: [opened]
  push:
  workflow_dispatch:
  schedule:
    - 1 * * * *
  pull_request:
    types: [opened]

jobs:
  comment:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/github-script@v7
        with:
          script: |
            github.rest.issues.createComment({
              issue_number: context.issue.number,
              owner: context.repo.owner,
              repo: context.repo.repo,
              body: 'ðŸ‘‹ Thanks for reporting! We will get to this as soon as we can!'
            })

  apply-label:
      runs-on: ubuntu-latest
      steps:
        - uses: actions/github-script@v7
          with:
            script: |
              github.rest.issues.addLabels({
                issue_number: context.issue.number,
                owner: context.repo.owner,
                repo: context.repo.repo,
                labels: ['Triage']
              })
  welcome:
      runs-on: ubuntu-latest
      steps:
         - uses: actions/github-script@v7
           with:
             script: |
                // Get a list of all issues created by the PR opener
                // See: https://octokit.github.io/rest.js/#pagination
                const creator = context.payload.sender.login
                const opts = github.rest.issues.listForRepo.endpoint.merge({
                  ...context.issue,
                  creator,
                  state: 'all'
                })
                const issues = await github.paginate(opts)

                for (const issue of issues) {
                  if (issue.number === context.issue.number) {
                    continue
                  }

                  if (issue.pull_request) {
                    return // Creator is already a contributor.
                  }
                }

                await github.rest.issues.createComment({
                  issue_number: context.issue.number,
                  owner: context.repo.owner,
                  repo: context.repo.repo,
                  body: `**Welcome**, new contributor!

                    Please make sure you've read our contributing guide and we look forward to reviewing your Pull request shortly âœ¨ You can also join our Discord and this will earn you the contributer role!`
                })
